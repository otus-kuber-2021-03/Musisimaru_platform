# Часть 0 | Развернем среду

Разворачивать буду **Kind**, как и в прошлой домашке. Как-то он стабильнее себя вел.

Утсановил кластер с настройками по-умолчанию, уже традиционно поправил `kube-scheduler.yaml` и `kube-controller-manager`. Готово

```bash
> kubectl get cs
Warning: v1 ComponentStatus is deprecated in v1.19+
NAME                 STATUS    MESSAGE             ERROR
scheduler            Healthy   ok
controller-manager   Healthy   ok
etcd-0               Healthy   {"health":"true"}
```

Попробуем может еще раз развернуть k9s. Может в этот раз заведется.

И действительно завелся. В этот раз пользовался установщиком `chocolaty` и  `windows terminal` , который в ***winstore*** распространяется.

# Часть 1 | Заведение пользователей

## Формулировка задачи

- Создать `Service Account` **bob**, дать ему роль **admin** в рамках всего кластера
- Создать `Service Account` **dave** без доступа к кластеру

...

# Часть 2 | Заведение прав

## Формулировка задачи

- Создать `Namespace` **prometheus**
- Создать `Service Account` **carol** в этом `Namespace`
- Дать всем `Service Account` в `Namespace` **prometheus** возможность делать `get`, `list`, `watch` в отношении `Pods` всего кластера

...

# Часть 3 | Task 03

- Создать `Namespace` **dev**
- Создать `Service Account` **jane** в `Namespace` **dev**
- Дать `jane` роль **admin** в рамках `Namespace` **dev**
- Создать `Service Account` **ken** в `Namespace` **dev**
- Дать **ken** роль **view** в рамках `Namespace` **dev**

...

# Ход работы над всеми задачами

В целом все по документации и схемам групп апи. Применил манифесты - все создалось. Где не создалось просто незначительные опечатки были. 

Как-то это меня смутило и я решил проверить аккаунты командами `kubectl auth can-i ...` . Че-т не похоже, что у кого-то на что-то есть права. Сами аккаунты и пространства имен создались. Но вот что-то не вижу доступов

Решил создать **RoleBinding** с полной околеситсей. И он создался. хмм... надо думать как по настоящему проверить доступы.

С подсказки преподавателя отправил на гит и в тестах увидел как это делается за одно узнал, что в целом почти все с первого раза правильно написал. А правирять доступ для системных аккаунтов следует по следующем шаблону
`kubectl auth can-i` `**command` `resourse`** `--as` `system:serviceaccount:**namespace**:**name**`

Пример

```bash
kubectl auth can-i list pods --as system:serviceaccount:prometheus:carol
```

После ряда опечаток на сонную голову все таки вооружился тестом и исправил манифесты, чтобы делали что нужно.